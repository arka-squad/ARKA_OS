# Audit ARKA_OS — checklist-audit-arka-v1

## Résumé exécutif
- La constitution ARKA_CORE reste modulaire et hiérarchisée : l'assemblage maître active explicitement les briques hiérarchie → règles → workflows → contrôles → mémoire → event bus, avec un ordre d'orchestration clair et des overrides par profil d'environnement.【F:ARKA_CORE/master-assembly.yaml†L1-L69】
- La couche profils s'appuie correctement sur les artefacts Core (action_keys, paths, matrices) pour exposer droits, limites et politiques d'autorisation, ce qui garantit un chaînage RBAC cohérent pour les agents et wake-ups ACME.【F:ARKA_PROFIL/master-profiles.yaml†L1-L19】【F:ARKA_AGENT/client/acme/wakeup/ARKAA08-WAKEUP-LEAD_DEV_BATISSEUR.yaml†L1-L23】
- Des lacunes structurelles demeurent : incohérences dans les droits (doublon `agp_rights`), scripts d'orchestration manquants, dossiers attendus absents (`build/`, `profiles/`, `scripts/`), et isolation des extensions perfectible.【F:ARKA_PROFIL/bricks/ARKPR05-RIGHTS.yaml†L1-L54】【af00eb†L1-L3】【078695†L1-L3】【489d51†L1-L3】【F:ARKA_CORE/ARKA_EXT/ARKAEXT01-SUBS-CI.yaml†L1-L11】

## Points forts
- **Modularité constitutionnelle documentée** : chaque brique ARKORE expose dépendances, invariants et contrats (hiérarchie, règles globales, matrices de contrôle, workflows, specs d'exécution). Ceci prévient la duplication et renforce l'interopérabilité des couches Core.【F:ARKA_CORE/bricks/ARKORE01-HIERARCHY.yaml†L1-L29】【F:ARKA_CORE/bricks/ARKORE02-GLOBAL-RULES.yaml†L1-L44】【F:ARKA_CORE/bricks/ARKORE06-CONTROL-MATRICES.yaml†L1-L65】【F:ARKA_CORE/bricks/ARKORE04-WORKFLOWS.yaml†L1-L62】【F:ARKA_CORE/bricks/ARKORE05-EXECUTION-SPECS.yaml†L1-L27】
- **Chaîne d'exécution LLM bien cadrée** : les Action Keys factorisent 96 opérations avec validations, hooks mémoire et instrumentation EventBus, ce qui simplifie l'audit des I/O et la traçabilité côté AGP.【F:ARKA_CORE/bricks/ARKORE12-ACTION-KEYS.yaml†L1-L88】【F:ARKA_CORE/bricks/ARKORE14-MEMORY-OPS.yaml†L1-L61】【F:ARKA_CORE/bricks/ARKORE16-EVENT-BUS.yaml†L1-L66】【F:ARKA_CORE/bricks/ARKORE15-AGP-REACTIVE-CONTROL.yaml†L1-L71】
- **Orchestration AGP / PMO harmonisée** : la boucle réactive AGP est paramétrable (zones overridables, garde-fous perf) et connectée aux matrices de contrôle, assurant des réactions rapides sans bloquer la production.【F:ARKA_CORE/bricks/ARKORE15-AGP-REACTIVE-CONTROL.yaml†L1-L71】【F:ARKA_CORE/bricks/ARKORE06-CONTROL-MATRICES.yaml†L1-L65】
- **RBAC et wake-up alignés** : action_sets, path_sets, droits, limites et politiques d'autorisation s'appuient tous sur les mêmes références Core ; les wake-ups ACME relient profils, capacités et experts avec missions contextualisées, ce qui renforce la cohérence agent/profil/wake-up.【F:ARKA_PROFIL/bricks/ARKPR03-ACTION-SETS.yaml†L1-L24】【F:ARKA_PROFIL/bricks/ARKPR04-PATH-SETS.yaml†L1-L16】【F:ARKA_PROFIL/bricks/ARKPR06-LIMITS.yaml†L1-L16】【F:ARKA_PROFIL/bricks/ARKPR07-AUTHZ-POLICY.yaml†L1-L14】【F:ARKA_PROFIL/bricks/ARKPR08-PROFILES-CATALOG.yaml†L1-L27】【F:ARKA_AGENT/client/acme/ARKAA19-AGENT-CAPABILITIES.yaml†L1-L76】【F:ARKA_AGENT/client/acme/experts/ARKA_AGENT04-lead-dev-batisseur.yaml†L1-L62】【F:ARKA_AGENT/client/acme/wakeup/ARKAA08-WAKEUP-LEAD_DEV_BATISSEUR.yaml†L1-L33】
- **Gouvernance des overrides explicite** : l'override `dev` démontre l'activation d'un pack d'extensions et de tuning ciblé de la boucle AGP, facilitant la personnalisation sans toucher au cœur.【F:ARKA_CORE/profiles/dev.override.yaml†L1-L6】【F:ARKA_CORE/ARKA_EXT/ARKAEXT01-SUBS-CI.yaml†L1-L11】

## Points faibles ou ambigus
- **Droits AGP incohérents** : `agp_rights` est défini deux fois avec des contenus différents (perte potentielle de restrictions ou d'accès selon l'ordre de fusion YAML). Il faut clarifier la source autoritaire et éviter le doublon.【F:ARKA_PROFIL/bricks/ARKPR05-RIGHTS.yaml†L1-L54】
- **Scripts d'orchestration introuvables** : l'Event Bus référence `ci/validate_delivery.py` mais aucun fichier correspondant n'est présent, ce qui empêche l'exécution de ce trigger critique d'évidence.【F:ARKA_CORE/bricks/ARKORE16-EVENT-BUS.yaml†L37-L64】【4a83c7†L1-L2】
- **Base dir EventBus invalide par défaut** : le dispatch local pointe vers `scripts/`, inexistant à la racine ; seuls des scripts sous `ARKA_CORE/scripts/handlers` existent, ce qui casse les hooks mémoire et US_CREATED sans override adapté.【F:ARKA_CORE/bricks/ARKORE16-EVENT-BUS.yaml†L37-L64】【af00eb†L1-L3】【86fff6†L1-L2】
- **Isolation des extensions à clarifier** : les packs d'extensions résident dans `ARKA_CORE/ARKA_EXT`, donc toujours couplés au Core, et l'override `dev` modifie directement des chemins Core ; cela fragilise la promesse "Ne modifiez pas ARKA_CORE" et complique le packaging externe.【F:ARKA_CORE/ARKA_EXT/README-EXT.md†L1-L5】【F:ARKA_CORE/ARKA_EXT/ARKAEXT01-SUBS-CI.yaml†L1-L11】【ac3cd9†L1-L3】
- **Référentiels attendus manquants** : absence de dossiers `build/`, `profiles/` (racine) et `scripts/` rend difficiles les conventions annoncées dans la checklist, tout comme le manque de documentation sur un pipeline de build.【078695†L1-L3】【489d51†L1-L3】【af00eb†L1-L3】
- **Catalogue événements partiel** : malgré une taxonomie riche, certains topics (ex. rejets de gate, escalades) n'ont pas de scripts ou de rejouabilité documentée ; la politique de replay mémoire reste à détailler au-delà du compactage quotidien.【F:ARKA_CORE/bricks/ARKORE16-EVENT-BUS.yaml†L18-L63】【F:ARKA_CORE/bricks/ARKORE14-MEMORY-OPS.yaml†L34-L57】

## Recommandations concrètes
- **Résoudre les conflits de droits** : consolider `agp_rights` dans un bloc unique, documenter la priorité de fusion et ajouter un test de lint YAML pour détecter les clés dupliquées dans les bricks profils.【F:ARKA_PROFIL/bricks/ARKPR05-RIGHTS.yaml†L1-L54】
- **Fournir les scripts référencés** : livrer `ci/validate_delivery.py` et déplacer/dupliquer les handlers sous un répertoire racine `scripts/` pour aligner le dispatch par défaut, ou ajuster le `base_dir` Core ; ajouter des checks CI garantissant la présence des scripts déclarés dans `ARKORE16` et les overrides.【F:ARKA_CORE/bricks/ARKORE16-EVENT-BUS.yaml†L37-L64】【86fff6†L1-L2】【4a83c7†L1-L2】
- **Isoler réellement les extensions** : extraire `ARKA_EXT` hors d'`ARKA_CORE`, fournir un dossier racine dédié (`./ARKA_EXT`) et définir une convention d'activation via `profiles/<env>.override.yaml` pour éviter la modification des chemins Core.【F:ARKA_CORE/ARKA_EXT/README-EXT.md†L1-L5】【F:ARKA_CORE/profiles/dev.override.yaml†L1-L6】
- **Structurer le build & packaging** : créer `build/` avec scripts/manifestes d'assemblage, documenter l'ordre Core → Profils → Extensions et fournir des hooks (Make, npm, etc.) pour exécuter l'audit des invariants ; capitaliser sur `master-assembly.yaml` pour générer une checklist automatisée.【F:ARKA_CORE/master-assembly.yaml†L1-L69】【078695†L1-L3】
- **Clarifier la rejouabilité des événements** : documenter dans `ARKORE16` la stratégie de replay (stockage, idempotence) et coupler avec `ARKORE14` (index mémoire) pour assurer la restauration d'état après incident ; envisager un topic `EVENT_REPLAYED` et des scripts dédiés.【F:ARKA_CORE/bricks/ARKORE16-EVENT-BUS.yaml†L18-L63】【F:ARKA_CORE/bricks/ARKORE14-MEMORY-OPS.yaml†L34-L57】
- **Renforcer la couverture wake-up/intents** : ajouter un index synthétique listant, pour chaque wake-up, le profil, les intents et les contraintes, afin de détecter rapidement les trous de couverture ou les redondances ; exploiter `ARKPR20` pour publier cette table et automatiser la validation lors de l'ajout d'experts.【F:ARKA_AGENT/client/acme/wakeup/ARKAA08-WAKEUP-LEAD_DEV_BATISSEUR.yaml†L1-L33】【F:ARKA_AGENT/client/acme/experts/ARKA_AGENT04-lead-dev-batisseur.yaml†L18-L62】【F:ARKA_PROFIL/bricks/ARKPR20-WAKEUP-POLICIES.yaml†L1-L14】
